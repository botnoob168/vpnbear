<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß - ‡∏ï‡∏•‡∏≤‡∏î</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVrDi8DIOkIGNhJlKfuyQM4tIRAI062MaV8sfjQKYVGjOBaZBOA87z+IhZE9DA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            position: relative;
        }
        
        .gradient-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            animation: backgroundMove 40s linear infinite;
        }
        
        @keyframes backgroundMove {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-30px) translateY(-30px); }
        }
        
        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        .floating-animation {
            animation: float 8s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
            75% { transform: translateY(-20px) rotate(-5deg); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .pet-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid rgba(226, 232, 240, 0.8);
            position: relative;
            overflow: hidden;
        }
        
        .pet-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .pet-card:hover::before {
            left: 100%;
        }
        
        .input-focus {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .input-focus:focus {
            transform: scale(1.02);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1), 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .sparkle {
            animation: sparkle 4s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
        }
        
        .rainbow-text {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .export-btn {
            background: linear-gradient(45deg, #00c851, #007e33);
            position: relative;
            overflow: hidden;
        }
        
        .export-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.3s;
        }
        
        .export-btn:hover::before {
            left: 100%;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Decorative Elements -->
    <div class="fixed top-10 left-10 text-6xl opacity-20 floating-animation">üêï</div>
    <div class="fixed top-32 right-20 text-4xl opacity-20 floating-animation" style="animation-delay: -2s;">üê±</div>
    <div class="fixed bottom-20 left-20 text-5xl opacity-20 floating-animation" style="animation-delay: -4s;">ü¶¥</div>
    <div class="fixed bottom-32 right-10 text-3xl opacity-20 floating-animation" style="animation-delay: -1s;">üêæ</div>

    <div class="container mx-auto px-4 py-8 relative z-10">
        <!-- Header -->
        <div class="text-center mb-12">
            <div class="inline-block glass-effect rounded-3xl px-8 py-6 mb-6">
                <h1 class="text-6xl font-extrabold text-white mb-3 drop-shadow-2xl rainbow-text">
                    üêïüê± ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß
                </h1>
                <p class="text-white/90 text-xl font-semibold drop-shadow-lg">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏•‡∏≤‡∏î - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</p>
                <div class="mt-4 flex justify-center space-x-4">
                    <span class="sparkle text-2xl">‚ú®</span>
                    <span class="sparkle text-2xl" style="animation-delay: 0.5s;">‚≠ê</span>
                    <span class="sparkle text-2xl" style="animation-delay: 1s;">üí´</span>
                </div>
            </div>
            
            <!-- Connection Status & Export Button -->
            <div class="mb-6 space-y-4">
                <div class="flex justify-center">
                    <div id="connectionStatus" class="text-sm font-medium bg-yellow-50 px-3 py-1 rounded-full border border-yellow-200">
                        <span class="text-yellow-600">üü° ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
                    </div>
                </div>
                
                <div id="syncStatus" class="text-center" style="display: none;"></div>
                
                <div class="flex justify-center space-x-4 flex-wrap gap-4">
                    <button id="exportBtn" class="export-btn text-white px-8 py-4 rounded-2xl font-bold text-lg shadow-2xl hover:shadow-3xl transform hover:scale-105 transition-all duration-300">
                        <span class="flex items-center justify-center">
                            <span class="mr-3 text-2xl">üìä</span>
                            ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel
                        </span>
                    </button>
                    
                    <button id="setupBtn" class="bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-4 rounded-2xl font-bold text-lg shadow-2xl hover:shadow-3xl transform hover:scale-105 transition-all duration-300">
                        <span class="flex items-center justify-center">
                            <span class="mr-3 text-2xl">‚öôÔ∏è</span>
                            ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
                        </span>
                    </button>
                    
                    <button id="firebaseBtn" class="bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-4 rounded-2xl font-bold text-lg shadow-2xl hover:shadow-3xl transform hover:scale-105 transition-all duration-300">
                        <span class="flex items-center justify-center">
                            <span class="mr-3 text-2xl">üî•</span>
                            ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Registration Form -->
            <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 card-hover">
                <div class="flex items-center justify-center mb-8">
                    <div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-full p-4 mr-4">
                        <span class="text-3xl">üìù</span>
                    </div>
                    <h2 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                        ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà
                    </h2>
                </div>
                
                <form id="petForm" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á *</label>
                            <input type="text" id="ownerName" required 
                                   class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                        </div>
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ *</label>
                            <input type="tel" id="ownerPhone" required 
                                   class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                        </div>
                    </div>

                    <div class="relative">
                        <label class="block text-sm font-semibold text-gray-700 mb-3">üè™ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡πÅ‡∏ú‡∏á</label>
                        <input type="text" id="shopName" 
                               class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üêæ ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á *</label>
                            <input type="text" id="petName" required 
                                   class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                        </div>
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üè∑Ô∏è ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó *</label>
                            <select id="petType" required 
                                    class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                <option value="‡∏´‡∏°‡∏≤">üêï ‡∏´‡∏°‡∏≤</option>
                                <option value="‡πÅ‡∏°‡∏ß">üê± ‡πÅ‡∏°‡∏ß</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üß¨ ‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå</label>
                            <input type="text" id="petBreed" 
                                   class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                        </div>
                        <div class="relative">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">üé® ‡∏™‡∏µ</label>
                            <input type="text" id="petColor" 
                                   class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium">
                        </div>
                    </div>

                    <!-- Vaccination Section -->
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-6 border-2 border-green-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <span class="text-2xl mr-2">üíâ</span>
                            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô
                        </h3>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="relative">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">ü¶† ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</label>
                                <select id="rabiesVaccine" 
                                        class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-green-500 focus:ring-0 text-gray-800 font-medium">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                                    <option value="‡∏â‡∏µ‡∏î‡πÅ‡∏•‡πâ‡∏ß">‚úÖ ‡∏â‡∏µ‡∏î‡πÅ‡∏•‡πâ‡∏ß</option>
                                    <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏â‡∏µ‡∏î">‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏â‡∏µ‡∏î</option>
                                    <option value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">‚ùì ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö</option>
                                </select>
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</label>
                                <input type="date" id="vaccineDate" 
                                       class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-green-500 focus:ring-0 text-gray-800 font-medium">
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-6 mt-4">
                            <div class="relative">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">üè• ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î</label>
                                <input type="text" id="vaccineLocation" 
                                       placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå, ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å"
                                       class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-green-500 focus:ring-0 text-gray-800 font-medium">
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">üíä ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                                <input type="text" id="otherVaccines" 
                                       placeholder="‡πÄ‡∏ä‡πà‡∏ô 5 in 1, 7 in 1"
                                       class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-green-500 focus:ring-0 text-gray-800 font-medium">
                            </div>
                        </div>
                    </div>

                    <div class="relative">
                        <label class="block text-sm font-semibold text-gray-700 mb-3">‚ú® ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
                        <textarea id="petDescription" rows="4" 
                                  class="w-full px-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-purple-500 focus:ring-0 text-gray-800 font-medium resize-none"
                                  placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏î‡∏≥‡∏ó‡∏µ‡πà‡∏´‡∏π, ‡∏Ç‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏ß, ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô ‡∏Ø‡∏•‡∏Ø"></textarea>
                    </div>

                    <button type="submit" 
                            class="w-full bg-gradient-to-r from-purple-600 via-pink-600 to-red-500 text-white py-4 px-8 rounded-2xl font-bold text-lg hover:from-purple-700 hover:via-pink-700 hover:to-red-600 transform hover:scale-105 transition-all duration-300 shadow-xl hover:shadow-2xl">
                        <span class="flex items-center justify-center">
                            <span class="mr-2">‚úÖ</span>
                            ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏¢!
                        </span>
                    </button>
                </form>
            </div>

            <!-- Pet List -->
            <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 card-hover">
                <div class="flex justify-between items-center mb-8">
                    <div class="flex items-center">
                        <div class="bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full p-4 mr-4">
                            <span class="text-3xl">üìã</span>
                        </div>
                        <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent">
                            ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
                        </h2>
                    </div>
                    <div class="bg-gradient-to-r from-green-400 to-blue-500 text-white px-6 py-3 rounded-2xl shadow-lg">
                        <div class="text-sm font-medium">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        <div class="text-2xl font-bold text-center" id="totalCount">0</div>
                        <div class="text-sm font-medium">‡∏ï‡∏±‡∏ß</div>
                    </div>
                </div>

                <!-- Search -->
                <div class="mb-6 relative">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <span class="text-2xl">üîç</span>
                    </div>
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á, ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå, ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤..." 
                           class="w-full pl-16 pr-5 py-4 border-2 border-gray-200 rounded-2xl input-focus focus:border-blue-500 focus:ring-0 text-gray-800 font-medium">
                </div>

                <!-- Filter -->
                <div class="mb-6">
                    <select id="typeFilter" class="px-5 py-3 border-2 border-gray-200 rounded-2xl input-focus focus:border-blue-500 focus:ring-0 text-gray-800 font-medium">
                        <option value="">üåü ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                        <option value="‡∏´‡∏°‡∏≤">üêï ‡∏´‡∏°‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</option>
                        <option value="‡πÅ‡∏°‡∏ß">üê± ‡πÅ‡∏°‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</option>
                    </select>
                </div>

                <!-- Pet List -->
                <div id="petList" class="space-y-4 max-h-96 overflow-y-auto pr-2">
                    <div class="text-center text-gray-500 py-12">
                        <div class="text-6xl mb-4 opacity-50">üêæ</div>
                        <div class="text-lg font-medium">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</div>
                        <div class="text-sm">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Google Sheets Configuration
        const GOOGLE_SHEETS_CONFIG = {
            scriptUrl: '', // ‡∏à‡∏∞‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            sheetId: '',   // ‡∏à‡∏∞‡πÉ‡∏™‡πà ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            enabled: false // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô true ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
        };

        // Firebase Configuration
        const FIREBASE_CONFIG = {
            apiKey: "",
            authDomain: "",
            projectId: "",
            storageBucket: "",
            messagingSenderId: "",
            appId: "",
            enabled: false
        };

        let firebaseApp = null;
        let firestore = null;

        let pets = JSON.parse(localStorage.getItem('marketPets')) || [];
        let petIdCounter = parseInt(localStorage.getItem('petIdCounter')) || 1;
        let isOnline = navigator.onLine;
        let syncQueue = JSON.parse(localStorage.getItem('syncQueue')) || [];

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï
        window.addEventListener('online', () => {
            isOnline = true;
            updateConnectionStatus();
            syncWithGoogleSheets();
        });

        window.addEventListener('offline', () => {
            isOnline = false;
            updateConnectionStatus();
        });

        // Firebase Functions
        function initializeFirebase() {
            if (!FIREBASE_CONFIG.enabled) return false;
            
            try {
                firebaseApp = firebase.initializeApp(FIREBASE_CONFIG);
                firestore = firebase.firestore();
                console.log('Firebase initialized successfully');
                return true;
            } catch (error) {
                console.error('Firebase initialization error:', error);
                return false;
            }
        }

        async function saveToFirebase(petData) {
            if (!firestore) return false;
            
            try {
                await firestore.collection('pets').doc(petData.id).set({
                    ...petData,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                return true;
            } catch (error) {
                console.error('Firebase save error:', error);
                return false;
            }
        }

        async function loadFromFirebase() {
            if (!firestore) return [];
            
            try {
                const snapshot = await firestore.collection('pets').orderBy('createdAt', 'desc').get();
                const firebasePets = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    firebasePets.push({
                        ...data,
                        id: doc.id
                    });
                });
                return firebasePets;
            } catch (error) {
                console.error('Firebase load error:', error);
                return [];
            }
        }

        async function deleteFromFirebase(petId) {
            if (!firestore) return false;
            
            try {
                await firestore.collection('pets').doc(petId).delete();
                return true;
            } catch (error) {
                console.error('Firebase delete error:', error);
                return false;
            }
        }

        function updateConnectionStatus() {
            const statusElement = document.getElementById('connectionStatus');
            
            if (isOnline && FIREBASE_CONFIG.enabled) {
                statusElement.innerHTML = '<span class="text-green-600">üü¢ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase</span>';
                statusElement.className = 'text-sm font-medium bg-green-50 px-3 py-1 rounded-full border border-green-200';
            } else if (isOnline && GOOGLE_SHEETS_CONFIG.enabled) {
                statusElement.innerHTML = '<span class="text-green-600">üü¢ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</span>';
                statusElement.className = 'text-sm font-medium bg-green-50 px-3 py-1 rounded-full border border-green-200';
            } else if (isOnline && !GOOGLE_SHEETS_CONFIG.enabled && !FIREBASE_CONFIG.enabled) {
                statusElement.innerHTML = '<span class="text-yellow-600">üü° ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)</span>';
                statusElement.className = 'text-sm font-medium bg-yellow-50 px-3 py-1 rounded-full border border-yellow-200';
            } else {
                statusElement.innerHTML = '<span class="text-red-600">üî¥ ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</span>';
                statusElement.className = 'text-sm font-medium bg-red-50 px-3 py-1 rounded-full border border-red-200';
            }
        }

        async function syncWithGoogleSheets() {
            if (!GOOGLE_SHEETS_CONFIG.enabled || !isOnline || syncQueue.length === 0) return;

            try {
                showSyncStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                
                for (const action of syncQueue) {
                    await sendToGoogleSheets(action);
                }
                
                // ‡∏•‡πâ‡∏≤‡∏á sync queue ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                syncQueue = [];
                localStorage.setItem('syncQueue', JSON.stringify(syncQueue));
                showSyncStatus('‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
            } catch (error) {
                console.error('Sync error:', error);
                showSyncStatus('‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á', 'error');
            }
        }

        async function sendToGoogleSheets(data) {
            if (!GOOGLE_SHEETS_CONFIG.enabled || !GOOGLE_SHEETS_CONFIG.scriptUrl) {
                throw new Error('Google Sheets ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤');
            }

            const response = await fetch(GOOGLE_SHEETS_CONFIG.scriptUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            return await response.json();
        }

        function addToSyncQueue(action) {
            syncQueue.push({
                ...action,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('syncQueue', JSON.stringify(syncQueue));
            
            // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            if (isOnline && GOOGLE_SHEETS_CONFIG.enabled) {
                syncWithGoogleSheets();
            }
        }

        function showSyncStatus(message, type = 'info') {
            const statusDiv = document.getElementById('syncStatus');
            statusDiv.textContent = message;
            
            statusDiv.className = 'text-sm font-medium px-3 py-2 rounded-lg transition-all duration-300 ';
            
            switch(type) {
                case 'success':
                    statusDiv.className += 'bg-green-100 text-green-700 border border-green-200';
                    break;
                case 'error':
                    statusDiv.className += 'bg-red-100 text-red-700 border border-red-200';
                    break;
                default:
                    statusDiv.className += 'bg-blue-100 text-blue-700 border border-blue-200';
            }
            
            statusDiv.style.display = 'block';
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            }
        }

        function savePets() {
            localStorage.setItem('marketPets', JSON.stringify(pets));
            localStorage.setItem('petIdCounter', petIdCounter.toString());
        }

        function generatePetId() {
            const id = `PET${petIdCounter.toString().padStart(3, '0')}`;
            petIdCounter++;
            return id;
        }

        async function addPet(petData) {
            const pet = {
                id: generatePetId(),
                ...petData,
                registeredDate: new Date().toLocaleDateString('th-TH')
            };
            pets.unshift(pet);
            savePets();
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firebase ‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
            if (FIREBASE_CONFIG.enabled) {
                try {
                    await saveToFirebase(pet);
                    showSyncStatus('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                } catch (error) {
                    console.error('Firebase save failed:', error);
                    showSyncStatus('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firebase ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß', 'error');
                }
            }
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô Google Sheets sync queue (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
            if (GOOGLE_SHEETS_CONFIG.enabled) {
                addToSyncQueue({
                    action: 'add',
                    data: pet
                });
            }
            
            renderPets();
            updateTotalCount();
        }

        async function deletePet(petId) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?')) {
                const petToDelete = pets.find(pet => pet.id === petId);
                pets = pets.filter(pet => pet.id !== petId);
                savePets();
                
                // ‡∏•‡∏ö‡∏à‡∏≤‡∏Å Firebase ‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
                if (FIREBASE_CONFIG.enabled && petToDelete) {
                    try {
                        await deleteFromFirebase(petId);
                        showSyncStatus('‡∏•‡∏ö‡∏à‡∏≤‡∏Å Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    } catch (error) {
                        console.error('Firebase delete failed:', error);
                        showSyncStatus('‡∏•‡∏ö‡∏à‡∏≤‡∏Å Firebase ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß', 'error');
                    }
                }
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô Google Sheets sync queue (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
                if (GOOGLE_SHEETS_CONFIG.enabled && petToDelete) {
                    addToSyncQueue({
                        action: 'delete',
                        data: { id: petId }
                    });
                }
                
                renderPets();
                updateTotalCount();
            }
        }

        function renderPets(petsToRender = pets) {
            const petList = document.getElementById('petList');
            
            if (petsToRender.length === 0) {
                petList.innerHTML = `
                    <div class="text-center text-gray-500 py-12">
                        <div class="text-6xl mb-4 opacity-50">üêæ</div>
                        <div class="text-lg font-medium">${pets.length === 0 ? '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á' : '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤'}</div>
                        <div class="text-sm">${pets.length === 0 ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å' : '‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á'}</div>
                    </div>
                `;
                return;
            }

            petList.innerHTML = petsToRender.map(pet => `
                <div class="pet-card rounded-2xl p-6 card-hover border-l-4 ${pet.petType === '‡∏´‡∏°‡∏≤' ? 'border-l-blue-500' : 'border-l-pink-500'}">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center space-x-4">
                            <div class="text-4xl ${pet.petType === '‡∏´‡∏°‡∏≤' ? 'bg-blue-100' : 'bg-pink-100'} rounded-full p-3">
                                ${pet.petType === '‡∏´‡∏°‡∏≤' ? 'üêï' : 'üê±'}
                            </div>
                            <div>
                                <h3 class="font-bold text-xl text-gray-800 mb-1">${pet.petName}</h3>
                                <div class="flex items-center space-x-2">
                                    <span class="bg-gradient-to-r ${pet.petType === '‡∏´‡∏°‡∏≤' ? 'from-blue-500 to-blue-600' : 'from-pink-500 to-pink-600'} text-white px-3 py-1 rounded-full text-xs font-semibold">
                                        ${pet.id}
                                    </span>
                                    <span class="text-xs text-gray-500">${pet.registeredDate}</span>
                                </div>
                            </div>
                        </div>
                        <button onclick="deletePet('${pet.id}')" 
                                class="bg-red-100 hover:bg-red-200 text-red-600 hover:text-red-700 px-3 py-2 rounded-xl text-sm font-medium transition-all duration-200 hover:scale-105">
                            üóëÔ∏è ‡∏•‡∏ö
                        </button>
                    </div>
                    
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center space-x-2">
                                <span class="text-blue-500">üë§</span>
                                <span class="font-semibold text-gray-700">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á:</span>
                                <span class="text-gray-800">${pet.ownerName}</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-green-500">üì±</span>
                                <span class="font-semibold text-gray-700">‡πÇ‡∏ó‡∏£:</span>
                                <span class="text-gray-800">${pet.ownerPhone}</span>
                            </div>
                            ${pet.shopName ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-purple-500">üè™</span>
                                    <span class="font-semibold text-gray-700">‡∏£‡πâ‡∏≤‡∏ô:</span>
                                    <span class="text-gray-800">${pet.shopName}</span>
                                </div>
                            ` : ''}
                            ${pet.petBreed ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-orange-500">üß¨</span>
                                    <span class="font-semibold text-gray-700">‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå:</span>
                                    <span class="text-gray-800">${pet.petBreed}</span>
                                </div>
                            ` : ''}
                            ${pet.petColor ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-pink-500">üé®</span>
                                    <span class="font-semibold text-gray-700">‡∏™‡∏µ:</span>
                                    <span class="text-gray-800">${pet.petColor}</span>
                                </div>
                            ` : ''}
                            ${pet.rabiesVaccine ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-red-500">üíâ</span>
                                    <span class="font-semibold text-gray-700">‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤:</span>
                                    <span class="text-gray-800">${pet.rabiesVaccine}</span>
                                </div>
                            ` : ''}
                            ${pet.vaccineDate ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-blue-500">üìÖ</span>
                                    <span class="font-semibold text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</span>
                                    <span class="text-gray-800">${new Date(pet.vaccineDate).toLocaleDateString('th-TH')}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <!-- Vaccine Info Section -->
                    ${(pet.vaccineLocation || pet.otherVaccines) ? `
                        <div class="bg-green-50 border-l-4 border-green-400 p-3 rounded-r-xl mb-3">
                            <div class="flex items-start space-x-2">
                                <span class="text-green-500 mt-0.5">üíâ</span>
                                <div class="w-full">
                                    <span class="font-semibold text-gray-700 text-sm">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</span>
                                    ${pet.vaccineLocation ? `<p class="text-gray-800 text-sm mt-1">üè• ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î: ${pet.vaccineLocation}</p>` : ''}
                                    ${pet.otherVaccines ? `<p class="text-gray-800 text-sm mt-1">üíä ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ: ${pet.otherVaccines}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    ` : ''}

                    ${pet.petDescription ? `
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-r-xl">
                            <div class="flex items-start space-x-2">
                                <span class="text-yellow-500 mt-0.5">‚ú®</span>
                                <div>
                                    <span class="font-semibold text-gray-700 text-sm">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©:</span>
                                    <p class="text-gray-800 text-sm mt-1">${pet.petDescription}</p>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function updateTotalCount() {
            const countElement = document.getElementById('totalCount');
            countElement.textContent = pets.length;
            countElement.classList.add('pulse-animation');
            setTimeout(() => {
                countElement.classList.remove('pulse-animation');
            }, 1000);
        }

        function filterPets() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            
            let filteredPets = pets.filter(pet => {
                const matchesSearch = !searchTerm || 
                    pet.ownerName.toLowerCase().includes(searchTerm) ||
                    pet.petName.toLowerCase().includes(searchTerm) ||
                    (pet.shopName && pet.shopName.toLowerCase().includes(searchTerm)) ||
                    pet.id.toLowerCase().includes(searchTerm);
                
                const matchesType = !typeFilter || pet.petType === typeFilter;
                
                return matchesSearch && matchesType;
            });
            
            renderPets(filteredPets);
        }

        function exportToExcel() {
            if (pets.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
                return;
            }

            try {
                // Check if XLSX is loaded
                if (typeof XLSX === 'undefined') {
                    alert('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ Excel ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
                    return;
                }

                // Prepare data for Excel
                const excelData = pets.map((pet, index) => ({
                    '‡∏•‡∏≥‡∏î‡∏±‡∏ö': index + 1,
                    '‡∏£‡∏´‡∏±‡∏™‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á': pet.id,
                    '‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á': pet.petName,
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': pet.petType,
                    '‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå': pet.petBreed || '-',
                    '‡∏™‡∏µ': pet.petColor || '-',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': pet.ownerName,
                    '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£': pet.ownerPhone,
                    '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡πÅ‡∏ú‡∏á': pet.shopName || '-',
                    '‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤': pet.rabiesVaccine || '-',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô': pet.vaccineDate ? new Date(pet.vaccineDate).toLocaleDateString('th-TH') : '-',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô': pet.vaccineLocation || '-',
                    '‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ': pet.otherVaccines || '-',
                    '‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©': pet.petDescription || '-',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô': pet.registeredDate
                }));

                // Create workbook and worksheet
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.json_to_sheet(excelData);

                // Set column widths
                const colWidths = [
                    { wch: 8 },   // ‡∏•‡∏≥‡∏î‡∏±‡∏ö
                    { wch: 15 },  // ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
                    { wch: 20 },  // ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
                    { wch: 10 },  // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                    { wch: 15 },  // ‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå
                    { wch: 15 },  // ‡∏™‡∏µ
                    { wch: 25 },  // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á
                    { wch: 15 },  // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£
                    { wch: 20 },  // ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡πÅ‡∏ú‡∏á
                    { wch: 18 },  // ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤
                    { wch: 18 },  // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô
                    { wch: 20 },  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô
                    { wch: 18 },  // ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                    { wch: 30 },  // ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©
                    { wch: 15 }   // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                ];
                ws['!cols'] = colWidths;

                // Add worksheet to workbook
                XLSX.utils.book_append_sheet(wb, ws, '‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á');

                // Generate filename with current date
                const now = new Date();
                const day = now.getDate().toString().padStart(2, '0');
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const year = (now.getFullYear() + 543).toString(); // Convert to Buddhist year
                const dateStr = `${day}-${month}-${year}`;
                const filename = `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á_${dateStr}.xlsx`;

                // Save file
                XLSX.writeFile(wb, filename);

                // Show success message
                const exportBtn = document.getElementById('exportBtn');
                const originalText = exportBtn.innerHTML;
                exportBtn.innerHTML = '<span class="flex items-center justify-center"><span class="mr-3 text-2xl">‚úÖ</span>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>';
                setTimeout(() => {
                    exportBtn.innerHTML = originalText;
                }, 3000);

            } catch (error) {
                console.error('Export error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            }
        }

        // Event Listeners
        document.getElementById('petForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const petData = {
                ownerName: document.getElementById('ownerName').value,
                ownerPhone: document.getElementById('ownerPhone').value,
                shopName: document.getElementById('shopName').value,
                petName: document.getElementById('petName').value,
                petType: document.getElementById('petType').value,
                petBreed: document.getElementById('petBreed').value,
                petColor: document.getElementById('petColor').value,
                rabiesVaccine: document.getElementById('rabiesVaccine').value,
                vaccineDate: document.getElementById('vaccineDate').value,
                vaccineLocation: document.getElementById('vaccineLocation').value,
                otherVaccines: document.getElementById('otherVaccines').value,
                petDescription: document.getElementById('petDescription').value
            };
            
            addPet(petData);
            this.reset();
            
            // Show success message
            const button = this.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="flex items-center justify-center"><span class="mr-2">üéâ</span>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</span>';
            button.classList.add('from-green-500', 'to-green-600');
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('from-green-500', 'to-green-600');
            }, 3000);
        });

        function showSetupModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl p-8 max-w-2xl w-full my-8 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6 sticky top-0 bg-white pb-4 border-b">
                        <h2 class="text-2xl font-bold text-gray-800">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets</h2>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-2xl font-bold hover:bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center">&times;</button>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-blue-800 mb-2">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</h3>
                            <ol class="list-decimal list-inside space-y-2 text-sm text-blue-700">
                                <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets:</strong> ‡πÄ‡∏õ‡∏¥‡∏î <a href="https://sheets.google.com" target="_blank" class="underline font-semibold">sheets.google.com</a> ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å "+" ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà</li>
                                <li><strong>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà "Untitled spreadsheet" ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô "‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß"</li>
                                <li><strong>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Sheet ID:</strong> ‡∏î‡∏π URL ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô docs.google.com/spreadsheets/d/<span class="bg-yellow-200 px-1 rounded">ID_‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ</span>/edit</li>
                                <li><strong>‡πÄ‡∏õ‡∏¥‡∏î Apps Script:</strong> ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏õ <a href="https://script.google.com" target="_blank" class="underline font-semibold">script.google.com</a></li>
                                <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å "New project" ‚Üí ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≠‡∏Å‡∏´‡∏°‡∏î ‚Üí ‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ</li>
                                <li><strong>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Sheet ID:</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô "YOUR_SHEET_ID" ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤</li>
                                <li><strong>Deploy:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‚Üí "New deployment" ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å type ‡πÄ‡∏õ‡πá‡∏ô "Web app"</li>
                                <li><strong>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permission:</strong> Execute as: "Me" ‡πÅ‡∏•‡∏∞ Who has access: "Anyone"</li>
                                <li><strong>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL:</strong> ‡∏´‡∏•‡∏±‡∏á Deploy ‡∏à‡∏∞‡πÑ‡∏î‡πâ Web app URL ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</li>
                            </ol>
                        </div>
                        
                        <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-red-800 mb-2">üö® ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ö‡πà‡∏≠‡∏¢:</h3>
                            <ul class="list-disc list-inside space-y-1 text-sm text-red-700">
                                <li>‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô "YOUR_SHEET_ID" ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î Apps Script</li>
                                <li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permission ‡∏ú‡∏¥‡∏î (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô "Anyone" ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "Only myself")</li>
                                <li>‡πÉ‡∏ä‡πâ URL ‡∏ú‡∏¥‡∏î (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Web app URL ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà URL ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå)</li>
                                <li>Google Sheets ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô Public ‡∏´‡∏£‡∏∑‡∏≠ Anyone with link</li>
                                <li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏î "Deploy" ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î "Deploy" ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÉ‡∏´‡∏°‡πà</li>
                            </ul>
                        </div>
                        
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-yellow-800 mb-2">üìù Google Apps Script Code (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ):</h3>
                            <textarea readonly class="w-full h-40 p-3 bg-gray-100 rounded-lg text-xs font-mono" onclick="this.select()">function doPost(e) {
  try {
    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô YOUR_SHEET_ID ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏à‡∏£‡∏¥‡∏á
    const sheet = SpreadsheetApp.openById('YOUR_SHEET_ID').getActiveSheet();
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ header ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°
    if (sheet.getLastRow() === 0) {
      sheet.appendRow([
        '‡∏£‡∏´‡∏±‡∏™‡∏™‡∏±‡∏ï‡∏ß‡πå', '‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå', '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó', '‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå', '‡∏™‡∏µ', 
        '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤', '‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤', 
        '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î', '‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ', '‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô'
      ]);
    }
    
    const data = JSON.parse(e.postData.contents);
    
    if (data.action === 'add') {
      const pet = data.data;
      sheet.appendRow([
        pet.id, pet.petName, pet.petType, pet.petBreed || '',
        pet.petColor || '', pet.ownerName, pet.ownerPhone,
        pet.shopName || '', pet.rabiesVaccine || '',
        pet.vaccineDate || '', pet.vaccineLocation || '',
        pet.otherVaccines || '', pet.petDescription || '',
        pet.registeredDate
      ]);
    }
    
    return ContentService.createTextOutput(JSON.stringify({success: true, message: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  return ContentService.createTextOutput(JSON.stringify({status: 'Google Apps Script is working!'}))
    .setMimeType(ContentService.MimeType.JSON);
}</textarea>
                            <p class="text-xs text-yellow-700 mt-2">‚ö†Ô∏è <strong>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô YOUR_SHEET_ID ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î!</p>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üîó Google Apps Script URL:</label>
                                <input type="url" id="scriptUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-0">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üìä Google Sheets ID:</label>
                                <input type="text" id="sheetId" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-0">
                                <p class="text-xs text-gray-500 mt-1">‡∏´‡∏≤ ID ‡∏à‡∏≤‡∏Å URL ‡∏Ç‡∏≠‡∏á Google Sheets: https://docs.google.com/spreadsheets/d/<strong>ID_‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ</strong>/edit</p>
                            </div>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button onclick="testConnection()" class="flex-1 bg-blue-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-blue-600 transition-colors">
                                üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                            </button>
                            <button onclick="saveGoogleSheetsConfig()" class="flex-1 bg-green-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-green-600 transition-colors">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                        </div>
                        
                        <div id="setupStatus" class="text-center" style="display: none;"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const savedConfig = JSON.parse(localStorage.getItem('googleSheetsConfig') || '{}');
            if (savedConfig.scriptUrl) document.getElementById('scriptUrl').value = savedConfig.scriptUrl;
            if (savedConfig.sheetId) document.getElementById('sheetId').value = savedConfig.sheetId;
        }

        async function testConnection() {
            const scriptUrl = document.getElementById('scriptUrl').value.trim();
            const sheetId = document.getElementById('sheetId').value.trim();
            const statusDiv = document.getElementById('setupStatus');
            
            if (!scriptUrl || !sheetId) {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡πÅ‡∏•‡∏∞ Sheet ID ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</div>';
                statusDiv.style.display = 'block';
                return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö URL
            if (!scriptUrl.includes('script.google.com') || !scriptUrl.includes('/exec')) {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Web app URL ‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ /exec</div>';
                statusDiv.style.display = 'block';
                return;
            }
            
            statusDiv.innerHTML = '<div class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</div>';
            statusDiv.style.display = 'block';
            
            try {
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ GET request ‡∏Å‡πà‡∏≠‡∏ô
                const getResponse = await fetch(scriptUrl + '?test=1', {
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (!getResponse.ok) {
                    throw new Error(`GET request failed: ${getResponse.status} - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Deploy ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permission ‡πÄ‡∏õ‡πá‡∏ô "Anyone"`);
                }
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ POST request
                const testData = {
                    action: 'add',
                    data: {
                        id: 'TEST001',
                        petName: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                        petType: '‡∏´‡∏°‡∏≤',
                        ownerName: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö',
                        ownerPhone: '000-000-0000',
                        registeredDate: new Date().toLocaleDateString('th-TH')
                    }
                };
                
                const postResponse = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                const result = await postResponse.json();
                
                if (postResponse.ok && result.success) {
                    statusDiv.innerHTML = '<div class="bg-green-100 text-green-700 px-4 py-2 rounded-lg">‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô<br><small>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô Google Sheets ‡πÅ‡∏•‡πâ‡∏ß</small></div>';
                } else {
                    throw new Error(result.error || `HTTP ${postResponse.status}`);
                }
                
            } catch (error) {
                let errorMessage = '‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ';
                
                if (error.message.includes('CORS')) {
                    errorMessage += '‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ "Who has access" ‡πÄ‡∏õ‡πá‡∏ô "Anyone"';
                } else if (error.message.includes('404')) {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏û‡∏ö URL - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Deploy ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Web app URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                } else if (error.message.includes('403')) {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permission';
                } else if (error.message.includes('YOUR_SHEET_ID')) {
                    errorMessage += '‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô YOUR_SHEET_ID ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î Apps Script';
                } else {
                    errorMessage += error.message;
                }
                
                statusDiv.innerHTML = `<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">${errorMessage}</div>`;
            }
        }

        function saveGoogleSheetsConfig() {
            const scriptUrl = document.getElementById('scriptUrl').value;
            const sheetId = document.getElementById('sheetId').value;
            const statusDiv = document.getElementById('setupStatus');
            
            if (!scriptUrl || !sheetId) {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</div>';
                statusDiv.style.display = 'block';
                return;
            }
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            const config = { scriptUrl, sheetId, enabled: true };
            localStorage.setItem('googleSheetsConfig', JSON.stringify(config));
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
            GOOGLE_SHEETS_CONFIG.scriptUrl = scriptUrl;
            GOOGLE_SHEETS_CONFIG.sheetId = sheetId;
            GOOGLE_SHEETS_CONFIG.enabled = true;
            
            statusDiv.innerHTML = '<div class="bg-green-100 text-green-700 px-4 py-2 rounded-lg">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>';
            statusDiv.style.display = 'block';
            
            updateConnectionStatus();
            
            // ‡∏õ‡∏¥‡∏î modal ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                document.querySelector('.fixed.inset-0').remove();
            }, 2000);
        }

        function showFirebaseSetupModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl p-8 max-w-2xl w-full my-8 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-6 sticky top-0 bg-white pb-4 border-b">
                        <h2 class="text-2xl font-bold text-gray-800">üî• ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase</h2>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-2xl font-bold hover:bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center">&times;</button>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="bg-orange-50 border-l-4 border-orange-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-orange-800 mb-2">üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase:</h3>
                            <ol class="list-decimal list-inside space-y-2 text-sm text-orange-700">
                                <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:</strong> ‡πÄ‡∏õ‡∏¥‡∏î <a href="https://console.firebase.google.com" target="_blank" class="underline font-semibold">Firebase Console</a> ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å "Create a project"</li>
                                <li><strong>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:</strong> ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå ‡πÄ‡∏ä‡πà‡∏ô "pet-registration-system"</li>
                                <li><strong>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ Firestore:</strong> ‡πÑ‡∏õ‡∏ó‡∏µ‡πà "Firestore Database" ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å "Create database" ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Start in test mode"</li>
                                <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏° Web App:</strong> ‡πÑ‡∏õ‡∏ó‡∏µ‡πà "Project settings" ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å "Add app" ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Web (</>) ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ App</li>
                                <li><strong>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Config:</strong> ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á App ‡∏à‡∏∞‡πÑ‡∏î‡πâ Firebase config object ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</li>
                                <li><strong>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Security Rules:</strong> ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Firestore ‚Üí Rules ‚Üí ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô allow read, write: if true; (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö)</li>
                            </ol>
                        </div>
                        
                        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-blue-800 mb-2">üí° ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Firebase:</h3>
                            <ul class="list-disc list-inside space-y-1 text-sm text-blue-700">
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ö‡∏ö Real-time ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
                                <li>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Server ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô</li>
                                <li>‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö Backup ‡πÅ‡∏•‡∏∞ Security ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß</li>
                                <li>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</li>
                                <li>‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏•‡πá‡∏Å</li>
                            </ul>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üîë API Key:</label>
                                <input type="text" id="firebaseApiKey" placeholder="AIzaSyC..." 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üåê Auth Domain:</label>
                                <input type="text" id="firebaseAuthDomain" placeholder="project-id.firebaseapp.com" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üìÅ Project ID:</label>
                                <input type="text" id="firebaseProjectId" placeholder="project-id" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üóÑÔ∏è Storage Bucket:</label>
                                <input type="text" id="firebaseStorageBucket" placeholder="project-id.appspot.com" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üì® Messaging Sender ID:</label>
                                <input type="text" id="firebaseMessagingSenderId" placeholder="123456789" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">üì± App ID:</label>
                                <input type="text" id="firebaseAppId" placeholder="1:123:web:abc123" 
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-0 text-sm">
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-xl">
                            <h3 class="font-bold text-yellow-800 mb-2">‚ö†Ô∏è Security Rules ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</h3>
                            <textarea readonly class="w-full h-20 p-3 bg-gray-100 rounded-lg text-xs font-mono" onclick="this.select()">rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if true;
    }
  }
}</textarea>
                            <p class="text-xs text-yellow-700 mt-2">‚ö†Ô∏è <strong>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> Rules ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Security ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ</p>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button onclick="testFirebaseConnection()" class="flex-1 bg-orange-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-orange-600 transition-colors">
                                üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                            </button>
                            <button onclick="saveFirebaseConfig()" class="flex-1 bg-green-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-green-600 transition-colors">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                            <button onclick="loadFirebaseData()" class="flex-1 bg-blue-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-blue-600 transition-colors">
                                üì• ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                        </div>
                        
                        <div id="firebaseSetupStatus" class="text-center" style="display: none;"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const savedConfig = JSON.parse(localStorage.getItem('firebaseConfig') || '{}');
            if (savedConfig.apiKey) document.getElementById('firebaseApiKey').value = savedConfig.apiKey;
            if (savedConfig.authDomain) document.getElementById('firebaseAuthDomain').value = savedConfig.authDomain;
            if (savedConfig.projectId) document.getElementById('firebaseProjectId').value = savedConfig.projectId;
            if (savedConfig.storageBucket) document.getElementById('firebaseStorageBucket').value = savedConfig.storageBucket;
            if (savedConfig.messagingSenderId) document.getElementById('firebaseMessagingSenderId').value = savedConfig.messagingSenderId;
            if (savedConfig.appId) document.getElementById('firebaseAppId').value = savedConfig.appId;
        }

        async function testFirebaseConnection() {
            const statusDiv = document.getElementById('firebaseSetupStatus');
            
            const config = {
                apiKey: document.getElementById('firebaseApiKey').value.trim(),
                authDomain: document.getElementById('firebaseAuthDomain').value.trim(),
                projectId: document.getElementById('firebaseProjectId').value.trim(),
                storageBucket: document.getElementById('firebaseStorageBucket').value.trim(),
                messagingSenderId: document.getElementById('firebaseMessagingSenderId').value.trim(),
                appId: document.getElementById('firebaseAppId').value.trim()
            };
            
            if (!config.apiKey || !config.projectId || !config.appId) {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å API Key, Project ID ‡πÅ‡∏•‡∏∞ App ID ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</div>';
                statusDiv.style.display = 'block';
                return;
            }
            
            statusDiv.innerHTML = '<div class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase...</div>';
            statusDiv.style.display = 'block';
            
            try {
                // ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase
                const testApp = firebase.initializeApp(config, 'test-app');
                const testFirestore = firebase.firestore(testApp);
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                await testFirestore.collection('test').doc('connection-test').set({
                    message: 'Firebase connection test',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                const doc = await testFirestore.collection('test').doc('connection-test').get();
                
                if (doc.exists) {
                    statusDiv.innerHTML = '<div class="bg-green-100 text-green-700 px-4 py-2 rounded-lg">‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>';
                    
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
                    await testFirestore.collection('test').doc('connection-test').delete();
                } else {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                }
                
                // ‡∏•‡∏ö test app
                await testApp.delete();
                
            } catch (error) {
                let errorMessage = '‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ';
                
                if (error.code === 'permission-denied') {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firestore Security Rules';
                } else if (error.code === 'invalid-api-key') {
                    errorMessage += 'API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                } else if (error.code === 'project-not-found') {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏û‡∏ö Project ID';
                } else {
                    errorMessage += error.message;
                }
                
                statusDiv.innerHTML = `<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">${errorMessage}</div>`;
            }
        }

        function saveFirebaseConfig() {
            const config = {
                apiKey: document.getElementById('firebaseApiKey').value.trim(),
                authDomain: document.getElementById('firebaseAuthDomain').value.trim(),
                projectId: document.getElementById('firebaseProjectId').value.trim(),
                storageBucket: document.getElementById('firebaseStorageBucket').value.trim(),
                messagingSenderId: document.getElementById('firebaseMessagingSenderId').value.trim(),
                appId: document.getElementById('firebaseAppId').value.trim(),
                enabled: true
            };
            
            const statusDiv = document.getElementById('firebaseSetupStatus');
            
            if (!config.apiKey || !config.projectId || !config.appId) {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</div>';
                statusDiv.style.display = 'block';
                return;
            }
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            localStorage.setItem('firebaseConfig', JSON.stringify(config));
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
            Object.assign(FIREBASE_CONFIG, config);
            
            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase
            if (initializeFirebase()) {
                statusDiv.innerHTML = '<div class="bg-green-100 text-green-700 px-4 py-2 rounded-lg">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Firebase ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>';
                updateConnectionStatus();
                
                // ‡∏õ‡∏¥‡∏î modal ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                setTimeout(() => {
                    document.querySelector('.fixed.inset-0').remove();
                }, 2000);
            } else {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase ‡πÑ‡∏î‡πâ</div>';
            }
            
            statusDiv.style.display = 'block';
        }

        async function loadFirebaseData() {
            if (!FIREBASE_CONFIG.enabled) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase ‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            const statusDiv = document.getElementById('firebaseSetupStatus');
            statusDiv.innerHTML = '<div class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase...</div>';
            statusDiv.style.display = 'block';
            
            try {
                const firebasePets = await loadFromFirebase();
                
                if (firebasePets.length > 0) {
                    // ‡∏ú‡∏™‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
                    const localPetIds = pets.map(pet => pet.id);
                    const newPets = firebasePets.filter(pet => !localPetIds.includes(pet.id));
                    
                    pets = [...newPets, ...pets];
                    savePets();
                    renderPets();
                    updateTotalCount();
                    
                    statusDiv.innerHTML = `<div class="bg-green-100 text-green-700 px-4 py-2 rounded-lg">‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà ${newPets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
                } else {
                    statusDiv.innerHTML = '<div class="bg-yellow-100 text-yellow-700 px-4 py-2 rounded-lg">üì≠ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firebase</div>';
                }
                
            } catch (error) {
                statusDiv.innerHTML = `<div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg">‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}</div>`;
            }
        }

        // Event Listeners
        document.getElementById('searchInput').addEventListener('input', filterPets);
        document.getElementById('typeFilter').addEventListener('change', filterPets);
        document.getElementById('exportBtn').addEventListener('click', exportToExcel);
        document.getElementById('setupBtn').addEventListener('click', showSetupModal);
        document.getElementById('firebaseBtn').addEventListener('click', showFirebaseSetupModal);

        // Initialize
        function initializeApp() {
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
            const savedGoogleConfig = JSON.parse(localStorage.getItem('googleSheetsConfig') || '{}');
            if (savedGoogleConfig.enabled) {
                GOOGLE_SHEETS_CONFIG.scriptUrl = savedGoogleConfig.scriptUrl;
                GOOGLE_SHEETS_CONFIG.sheetId = savedGoogleConfig.sheetId;
                GOOGLE_SHEETS_CONFIG.enabled = true;
            }
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase
            const savedFirebaseConfig = JSON.parse(localStorage.getItem('firebaseConfig') || '{}');
            if (savedFirebaseConfig.enabled) {
                Object.assign(FIREBASE_CONFIG, savedFirebaseConfig);
                initializeFirebase();
            }
            
            updateConnectionStatus();
            renderPets();
            updateTotalCount();
            
            // ‡∏•‡∏≠‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà
            if (GOOGLE_SHEETS_CONFIG.enabled && isOnline) {
                setTimeout(syncWithGoogleSheets, 1000);
            }
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            if (FIREBASE_CONFIG.enabled && isOnline) {
                setTimeout(async () => {
                    try {
                        const firebasePets = await loadFromFirebase();
                        if (firebasePets.length > 0) {
                            const localPetIds = pets.map(pet => pet.id);
                            const newPets = firebasePets.filter(pet => !localPetIds.includes(pet.id));
                            
                            if (newPets.length > 0) {
                                pets = [...newPets, ...pets];
                                savePets();
                                renderPets();
                                updateTotalCount();
                                showSyncStatus(`‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà ${newPets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');
                            }
                        }
                    } catch (error) {
                        console.error('Auto-load Firebase data failed:', error);
                    }
                }, 2000);
            }
        }

        initializeApp();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ef0748a03afd3c',t:'MTc1NTE1OTU3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
